---
title: "vcd"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(vcd)
```
Package 'vcd'
December 6, 2017
Version 1.4-4
Title Visualizing Categorical Data

#### Desription
 Visualization techniques, data sets, summary and inference
procedures aimed particularly at categorical data. Special
emphasis is given to highly extensible grid graphics. The
package was package was originally inspired by the book
``Visualizing Categorical Data'' by * Michael Friendly and is
now the main support package for a new book,
``Discrete Data Analysis with R'' by * Michael Friendly and
David Meyer (2015).
LazyLoad yes
LazyData yes
Depends R (>= 2.4.0), grid
Suggests KernSmooth, mvtnorm, kernlab, HSAUR, coin
Imports stats, utils, MASS, grDevices, colorspace, lmtest
License GPL-2
NeedsCompilation no
Author David Meyer [aut, cre],
Achim Zeileis [aut] (<https://orcid.org/0000-0003-0918-3766>),
Kurt Hornik [aut],
Florian Gerber [ctb],
* Michael Friendly [ctb]
Maintainer David Meyer <David.Meyer@R-project.org>
Repository CRAN
Date/Publication 2017-12-06 10:51:14 UTC
R topics documented:
agreementplo. . 3
Arthriti. . 6
asso. 7



```

hls HLS Color Specification

#### Desription

Create a HLS color from specifying hue, luminance and saturation.

#### Usage
<pre><code>

hls(h = 10.51)

</code></pre>
#### Arguments

* ``h`` : hue value in [0, 1].
l luminance value in [0, 1].
s saturation value in [0, 1].
Details
HLS colors are a similar specification of colors as HSV colors, but using hue/luminance/saturation
rather that hue/saturation/value.
Author(s)
Achim Zeileis <Achim.Zeileis@R-project.org>
See Also
hsv, hcl2hex, polarLUV

#### Examples
```{r}

## an HLS color wheel
pie(rep(1, 12), col = sapply(1:12/12, function(x) hls(x)))
```
iobSatisfaction Job Satisfaction Data

#### Desription

Data from Petersen (1968) about the job satisfaction of 715 blue collar workers, selected from
Danish Industry in 1968.

#### Usage
<pre><code>

data("JobSatisfaction")

</code></pre>
#### Format 

A data frame with 8 observations and 4 variables.
Freq frequency.
management factor indicating quality of management (bad, good).
supervisor factor indicating supervisor's job satisfaction (low, high).
own factor indicating worker's own job satisfaction (low, high).

#### Source
E. B. Andersen (1991), The Statistical Analysis of Categorical Data, Table 5.4.

References
E. B. Andersen (1991), The Statistical Analysis of Categorical Data. 2nd edition. Springer-Verlag,
Berlin.
E. Petersen (1968), Job Satisfaction in Denmark. (In Danish). Mentalhygiejnisk Forlag, Copenhagen.

#### Examples
```{r}

data("JobSatisfaction")
structable(~ ., data = JobSatisfaction)
mantelhaen.test(xtabs(Freq ~ own + supervisor + management,
data = JobSatisfaction))
```


labeling_cells_list Labeling Functions for Strucplots

#### Desription

These functions generate labeling functions that produce labels for strucplots.

#### Usage
<pre><code>

labeling_cells(labels = TRUE, varnames = TRUE,
abbreviate_labels = FALSE, abbreviate_varnames = FALSE,
gp_text = gpar(), lsep = ": ", lcollapse = "\n",
just = "center", pos = "center", rot = 0,
margin = unit(0.5, "lines"), clip_cells = TRUE,
text = NULL, ...)
labeling_list(gp_text = gpar(), just = "left", pos = "left", lsep = ": ",
se", offset = unit(c(2, 2), "lines"),
varnames = TRUE, cols = 2, ...)

</code></pre>
#### Arguments

* ``labels``: vector of logicals indicating, for each dimension, whether labels for the factor
levels should be drawn or not. 
Value 
 are recycled as needed.
varnames vector of logicals indicating, for each dimension, whether variable names should
be drawn. 
#### Value 
 are recycled as needed.
abbreviate_labels
vector of integers or logicals indicating, for each dimension, the number of characters
the labels should be abbreviated to. TRUE means 1 character, FALSE causes
no abbreviation. 
#### Value 
 are recycled as needed.
abbreviate_varnames
vector of integers or logicals indicating, for each dimension, the number of characters
the variable (i.e., dimension) names should be abbreviated to. TRUE means
1 character, FALSE causes no abbreviation. 
#### Value 
 are recycled as needed.
* ``gp_text``:  object of class "gpar" used for the text drawn.
lsep character that separates variable names from the factor levels.
60 labeling_cells_list
sep character that separates the factor levels (only used for labeling_list).
offset object of class "unit" of length 2 specifying the offset in x- and y-direction of
the text block drawn under the strucplot (only used for labeling_list).
cols number of text columns (only used for labeling_list).
lcollapse character that separates several variable name/factor level-combinations. Typically
a line break. (Only used for labeling_cells.)
just, pos character string of length 1 (labeling_list) or at most 2 (labeling_cells)
specifying the labels' horizontal position and justification (horizontal and vertical
for labeling_cells).
rot rotation angle in degrees, used for all labels (only used for labeling_cells).
margin object of class "unit" (a numeric value is converted to "lines") specifying an
offset from the cell borders (only used for labeling_cells).
clip_cells logical indicating whether text should be clipped at the cell borders (only used
for labeling_cells).
text Optionally, a character table of the same dimensions than the contingency table
whose entries will then be used instead of the labels. NA entries are not
drawn. This allows custom cell annotations (see 
#### Examples
```{r}
). Only used for
labeling_cells.
... Currently not used.
Details
These functions generate labeling functions that can add different kinds of labels to an existing plot.
Typically they are supplied to strucplot which then generates and calls the labeling function. They
assume that a strucplot has been drawn and the corresponding viewport structure is pushed, so that
by navigating through the viewport tree the labels can be positioned appropriately.
This help page only documents labeling_list and labeling_cells; more functions are described
on the help page for labeling_border.
The functions can also be used 'stand-alone' as shown in the 
#### Examples
```{r}
.
Using labeling_list will typically necessitate a bottom margin adjustment.
Value
A function with 
</code></pre>
#### Arguments
:
d "dimnames" attribute from the visualized contingency table, or the visualized
table itself from which the "dimnames" attributes will then be extracted.
split_vertical vector of logicals indicating the split directions.
condvars integer vector of conditioning dimensions
Author(s)
David Meyer <David.Meyer@R-project.org>
legends 61
References
Meyer, D., Zeileis, A., and Hornik, K. (2006), The strucplot framework: Visualizing multi-way contingency
tables with vcd. Journal of Statistical Software, 17(3), 1-48. URL http://www.jstatsoft.org/v17/i03/
and available as vignette("strucplot").
See Also
labeling_border, structable, grid.text

#### Examples
```{r}

data("Titanic")
mosaic(Titanic, labeling = labeling_cells)
mosaic(Titanic, labeling = labeling_list)
## A more complex example, adding the observed frequencies
## to a mosaic plot:
tab <- ifelse(Titanic < 6, NA, Titanic)
mosaic(Titanic, pop = FALSE)
labeling_cells(text = tab, margin = 0)(Titanic)
legends Legend Functions for Strucplots

#### Desription

These functions generate legend functions for residual-based shadings.

#### Usage
<pre><code>

legend_resbased(fontsize = 12, fontfamily = "",
x = unit(1, "lines")unit(0.1,"npc"),
height = unit(0.8, "npc"),
width = unit(0.7, "lines"),
digits = 2, check_overlap = TRUE, text = NULL,
steps = 200, ticks = 10, pvalue = TRUE, range = NULL)
legend_fixed(fontsize = 12, fontfamily = ""unit(1, "lines")NULL,
height = NULL, width = unit(1.5, "lines"), steps = 200,
digits = 1, space = 0.05, text = NULL, range = NULL)

</code></pre>
#### Arguments

fontsize fontsize of title and p-value text.
fontfamily fontfamily of all text.
x, y objects of class "unit" indicating the coordinates of the title. For legend_fixed,
the default for y is computed as to leave enough space for the specified text.
62 legends
height, width object of class "unit" indicating the height/width of the legend. For legend_fixed,
the default for y is computed as to align upper margins of legend and actual plot.
digits number of digits for the scale labels.
check_overlap logical indicating whether overlap of scale labels should be inhibited or not.
space For legend_fixed only: proportion of space between the tiles.
text character string indicating the title of the legend.
steps granularity of the color gradient.
ticks number of scale ticks.
pvalue logical indicating whether the p-value should be visualized under the scale or
not.
range Numeric vector of length 2 for setting the legend range. Computed from the
residuals if omitted. NA 
#### Value 
 are replaced by the corresponding minimum /
maximum of the residuals.
Details
These functions generate legend functions for residual-based shadings, visualizing deviations from
expected 
#### Value 
 of an hypothesized independence model. Therefore, the legend uses a supplied
shading function to visualize the color gradient for the residuals range. legend_fixed is inspired
by the legend used in mosaicplot. For more details on the shading functions and their return

#### Value 
, see shadings.
Value
A function with 
</code></pre>
#### Arguments
:
residuals residuals from the fitted independence model to be visualized.
shading shading function computing colors from residuals (see details).
autotext character vector indicating the title to be used when no text argument is specified.
Allows strucplot to generate sensible defaults depending on the residuals
type.
Author(s)
David Meyer <David.Meyer@R-project.org>
References
Meyer, D., Zeileis, A., and Hornik, K. (2006), The strucplot framework: Visualizing multi-way contingency
tables with vcd. Journal of Statistical Software, 17(3), 1-48. URL http://www.jstatsoft.org/v17/i03/
and available as vignette("strucplot").
Meyer, D., Zeileis, A., Hornik, K. (2003), Visualizing independence using extended association
plots. Proceedings of the 3rd International Workshop on Distributed Statistical Computing, K.
Hornik, F. Leisch, A. Zeileis (eds.), ISSN 1609-395X. https://www.R-project.org/conferences/
DSC-2003/Proceedings/
Lifeboats 63
See Also
structable, shadings

#### Examples
```{r}

data("Titanic")
mosaic(Titanic, shade = TRUE, legend = legend_resbased)
mosaic(Titanic, shade = TRUE, legend = legend_fixed, gp = shading_Friendly)
```


Pairs plot panel functions for diagonal cells
Diagonal Panel Functions for Table Pairs Plot

#### Desription

Diagonal panel functions for pairs.table.

#### Usage
<pre><code>

pairs_barplot(gp_bars = NULL,
gp_vartext = gpar(fontsize = 17),
gp_leveltext = gpar(),
just_leveltext = c("center", "bottom"),
just_vartext = c("center", "top"),
rot = 0, abbreviate = FALSE, check_overlap = TRUE, fill = "grey",
var_offset = unit(1, "npc"), ...)
pairs_text(dimnames = TRUE, gp_vartext = gpar(fontsize = 17),
gp_leveltext = gpar(), gp_border = gpar(), ...)
pairs_diagonal_text(varnames = TRUE, gp_vartext = gpar(fontsize = 17, fontface = "bold"),
gp_leveltext = gpar(), gp_border = gpar(), pos = c("right","top"),
84 Pairs plot panel functions for diagonal cells
distribute = c("equal","margin"), rot = 0, ...)
pairs_diagonal_mosaic(split_vertical = TRUE, margins = unit(0, "lines"),
offset_labels = -0.4, offset_varnames = 0,
gp = NULL, fill = "grey", labeling = labeling_
#### Value 
, alternate_labels = TRUE, ...)

</code></pre>
#### Arguments

dimnames vector of logicals indicating whether the factor levels should be displayed (only
used for pairs_text).
varnames vector of logicals indicating whether the variable names should be displayed
(only used for pairs_text_diagonal).
gp_bars object of class "gpar" used for bars (only used for pairs_barplot). If unspecified,
the default is to set the fill component of this object to the fill
argument.
gp_vartext object of class "gpar" used for the factor names.
gp_leveltext object of class "gpar" used for the factor levels.
gp_border object of class "gpar" used for the border (only used for pairs_text).
gp object of class "gpar" used for the tiles (only used for pairs_diagonal_mosaic).
If unspecified, the default is to set the fill component of this object to the fill
argument.
fill color vector or palette function used for the fill colors of bars (for pairs_barplot)
or tiles (for pairs_diagonal_mosaic).
labeling labeling function, passed to mosaic()
alternate_labels
should labels alternate top/bottom?
just_leveltext, just_vartext
character string indicating the justification for variable names and levels.
pos character string of length 2 controlling the horizontal and vertical position of the
variable names (only used for pairs_text_diagonal).
rot rotation angle for the variable levels.
distribute character string indicating whether levels should be distributed equally or according
to the margins (only used for pairs_text_diagonal).
abbreviate integer or logical indicating the number of characters the labels should be abbreviated
to. TRUE means 1 character, FALSE causes no abbreviation.
check_overlap If TRUE, some levels will suppressed to avoid overlapping, if any.
split_vertical vector of logicals of length k, where k is the number of margins of x (
#### Value 

are recycled as needed). A TRUE component indicates that the tile(s) of the corresponding
dimension should be split vertically, FALSE means horizontal splits.
Default is FALSE.
margins either an object of class "unit" of length 4, or a numeric vector of length 4.
The elements are recycled as needed. The four components specify the top,
right, bottom, and left margin of the plot, respectively. When a numeric vector
is supplied, the numbers are interpreted as "lines" units. In addition, the
unit or numeric vector may have named 
</code></pre>
#### Arguments
 ('top', 'right', 'bottom',
Pairs plot panel functions for diagonal cells 85
and 'left'), in which case the non-named 
</code></pre>
#### Arguments
 specify the default 
#### Value 

(recycled as needed), overloaded by the named 
</code></pre>
#### Arguments
.
offset_labels, offset_varnames
numeric vector of length 4 indicating the offset of the labels (variable names)
for each of the four sides of the plot.
var_offset object of class "unit" specifying the offset of variable names from the bottom
of the bar plots created by pairs_barplot. If numeric, the unit defaults to
"npc".
... other parameters passed to the underlying graphics functions.
Details
In the diagonal cells, the pairsplot visualizes statistics or in
</code></pre>
#### Format 
ion for each dimension (that is: the
single factors) alone. pairs_text displays the factor's name, and optionally also the factor levels.
pairs_barplot produces a bar plot of the corresponding factor, along with the factor's name.
Value
A function with one argument: the marginal table for the corresponding dimension.
Author(s)
David Meyer <David.Meyer@R-project.org>
See Also
pairs.table, pairs_assoc, pairs_mosaic

#### Examples
```{r}

data("UCBAdmissions")
pairs(UCBAdmissions) # pairs_barplot is default
pairs(UCBAdmissions, diag_panel = pairs_text)
pairs(UCBAdmissions, diag_panel = pairs_diagonal_text)
pairs(Titanic, diag_panel = pairs_diagonal_text)
pairs(Titanic, diag_panel = pairs_diagonal_text(distribute = "margin"))
pairs(Titanic,
diag_panel = pairs_diagonal_text(distribute = "margin", rot = 45))
86 Pairs plot panel functions for off-diagonal cells
```

RepVict 97
RepVict Repeat Victimization Data

#### Desription

Data from Reiss (1980) given by Fienberg (1980) about instances of repeat victimization for households
in the U.S. National Crime Survey.

#### Usage
<pre><code>

data("RepVict")

</code></pre>
#### Format 

A 2-dimensional array resulting from cross-tabulating victimization. The variables and their levels
are as follows:
No Name Levels
1 First Victimization Rape, Assault, Robbery, Pickpocket, Personal Larceny,
Burglary, Household Larceny, Auto Theft
2 Second Victimization Rape, Assault, Robbery, Pickpocket, Personal Larceny,
Burglary, Household Larceny, Auto Theft
Source
* Michael Friendly (2000), Visualizing Categorical Data, page 113.
References
S. E. Fienberg (1980), The Analysis of Cross-Classified Categorical Data, MIT Press, Cambridge,
2nd edition.
A. J. J. Reiss (1980), Victim proneness by type of crime in repeat victimization. In S. E. Fienberg
& A. J. J. Reiss (eds.), Indicators of Crime and Criminal Justice. U.S. Government Printing Office,
Washington, DC.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("RepVict")
mosaic(RepVict[-c(4,7),-c(4,7)], gp = shading_max,
main = "Repeat Victimization Data")
98 Rochdale
Rochdale Rochdale Data

#### Desription

In
</code></pre>
#### Format 
ion on 665 households of Rochdale, Lancashire, UK. The study was conducted to identify
influence factors on economical activity of wives.

#### Usage
<pre><code>

data("Rochdale")

</code></pre>
#### Format 

A 8-dimensional array resulting from cross-tabulating 665 observations on 8 variables. The variables
and their levels are as follows:
No Name Levels
1 EconActive yes, no
2 Age <38, >38
3 HusbandEmployed yes, no
4 Child yes, no
5 Education yes, no
6 HusbandEducation yes, no
7 Asian yes, no
8 HouseholdWorking yes, no
Note
Many observations are missing: only 91 out of all 256 combinations contain in
</code></pre>
#### Format 
ion.
Source
Whittaker (1990).
References
H. Hofmann (2003). Constructing and reading mosaicplots. Computational Statistics & Data Analysis,
43, 4, 565-580.
J. Whittaker (1990), Graphical Models on Applied Multivariate Statistics, Wiley, New York.

#### Examples
```{r}

data("Rochdale")
mosaic(Rochdale)
rootogram 99
rootogram Rootograms

#### Desription

Rootograms of observed and fitted 
#### Value 
.

#### Usage
<pre><code>

## Default S3 method:
rootogram(x, fitted, names = NULL, scale = c("sqrt", "raw"),
type = c("hanging", "standing", "deviation"),
shade = FALSE, legend = TRUE,
legend_args = list(x = 00.2, height = 0.6), df = NULL,
rect_gp = NULL, rect_gp_args = list(),
lines_gp = gpar(col = "red", lwd = 2),
points_gp = gpar(col = "red"), pch = 19,
xlab = NULL, ylab = NULL, ylim = NULL,
main = NULL, sub = NULL,
margins = unit(0, "lines"),
title_margins = NULL, legend_width = NULL,
main_gp = gpar(fontsize = 20),
sub_gp = gpar(fontsize = 15),
name = "rootogram", prefix = "",
keep_aspect_ratio = FALSE,
newpage = TRUE, pop = TRUE,
return_grob = FALSE, ...)

</code></pre>
#### Arguments

x either a vector or a 1-way table of frequencies.
fitted a vector of fitted frequencies.
names a vector of names passed to grid_barplot, if set to NULL the names of x are
used.
scale a character string indicating whether the 
#### Value 
 should be plotted on the raw or
square root scale.
type a character string indicating if the bars for the observed frequencies should be
hanging or standing or indicate the deviation between observed and fitted
frequencies.
shade logical specifying whether rect_gp should be set to colors corresponding to the
pearson residuals, i.e., if a residual-based shading should be applied to the bars.
legend either a legend-generating function, or a legend function (see details and legends),
or a logical. If legend is NULL or TRUE and gp is a function, legend defaults to
legend_resbased.
legend_args list of 
</code></pre>
#### Arguments
 for the legend-generating function, if specified.
100 rootogram
df degrees of freedom passed to the shading functions used for inference.
rect_gp a "gpar" object controlling the grid graphical parameters of the rectangles,
shading function or a corresponding generating function (see shadings). If
unspecified and no shading is applied, defaults to light grey fill color for the
bars.
rect_gp_args list of 
</code></pre>
#### Arguments
 for the shading-generating function, if specified for rect_gp.
lines_gp a "gpar" object controlling the grid graphical parameters of the lines.
points_gp a "gpar" object controlling the grid graphical parameters of the points.
pch plotting character for the points.
xlab a label for the x axis.
ylab a label for the y axis.
ylim limits for the y axis.
main either a logical, or a character string used for plotting the main title. If main is a
logical and TRUE, the name of the object supplied as x is used.
sub a character string used for plotting the subtitle. If sub is a logical and TRUE and
main is unspecified, the name of the object supplied as x is used.
margins either an object of class "unit" of length 4, or a numeric vector of length 4.
The elements are recycled as needed. The four components specify the top,
right, bottom, and left margin of the plot, respectively. When a numeric vector
is supplied, the numbers are interpreted as "lines" units. In addition, the
unit or numeric vector may have named 
</code></pre>
#### Arguments
 ('top', 'right', 'bottom',
and 'left'), in which case the non-named 
</code></pre>
#### Arguments
 specify the default 
#### Value 

(recycled as needed), overloaded by the named 
</code></pre>
#### Arguments
.
title_margins either an object of class "unit" of length 2, or a numeric vector of length 2. The
elements are recycled as needed. The two components specify the top and bottom
title margin of the plot, respectively. The default for each specified title are
2 lines (and 0 else), except when a legend is plotted and keep_aspect_ratio
is TRUE: in this case, the default 
#### Value 
 of both margins are set as to align the
heights of legend and actual plot. When a numeric vector is supplied, the numbers
are interpreted as "lines" units. In addition, the unit or numeric vector may
have named 
</code></pre>
#### Arguments
 ('top' and 'bottom'), in which case the non-named argument
specify the default value (recycled as needed), overloaded by the named arguments.
legend_width An object of class "unit" of length 1 specifying the width of the legend (if any).
Default: 5 lines.
main_gp, sub_gp
object of class "gpar" containing the graphical parameters used for the main
(sub) title, if specified.
name name of the plotting viewport.
keep_aspect_ratio
logical indicating whether the aspect ratio should be fixed or not.
prefix optional character string used as a prefix for the generated viewport and grob
names.

newpage logical. Should grid.newpage be called before plotting?
pop logical. Should the viewport created be popped?
return_grob logical. Should a snapshot of the display be returned as a grid grob?
... further 
</code></pre>
#### Arguments
 passed to grid_barplot.
Details
The observed frequencies are displayed as bars and the fitted frequencies as a line. By default a sqrt
scale is used to make the smaller frequencies more visible.
Author(s)
Achim Zeileis <Achim.Zeileis@R-project.org>, David Meyer <David.Meyer@R-project.org>
References
J. W. Tukey (1977), Exploratory Data Analysis. Addison Wesley, Reading, MA.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.
See Also
grid_barplot

#### Examples
```{r}

## Simulated data 
#### Examples
```{r}
:
dummy <- rnbinom(200, size = 1.5, prob = 0.8)
observed <- table(dummy)
fitted1 <- dnbinom(as.numeric(names(observed)),
size = 1.5, prob = 0.8) * sum(observed)
fitted2 <- dnbinom(as.numeric(names(observed)),
size = 2, prob = 0.6) * sum(observed)
rootogram(observed, fitted1)
rootogram(observed, fitted2)
## Real data 
#### Examples
```{r}
:
data("HorseKicks")
HK.fit <- goodfit(HorseKicks)
summary(HK.fit)
plot(HK.fit)
## or equivalently
rootogram(HK.fit)
data("Federalist")
F.fit <- goodfit(Federalist, type = "nbinomial")
summary(F.fit)
plot(F.fit)
## (Pearson) residual-based shading
data("Federalist")
Fed_fit0 <- goodfit(Federalist, type = "poisson")
102 Saxony
plot(Fed_fit0, shade = TRUE)
Saxony Families in Saxony

#### Desription

Data from Geissler, cited in Sokal & Rohlf (1969) and Lindsey (1995) on gender distributions in
families in Saxony in the 19th century.

#### Usage
<pre><code>

data("Saxony")

</code></pre>
#### Format 

A 1-way table giving the number of male children in 6115 families of size 12. The variable and its
levels are
No Name Levels
1 nMales 0, 1. , 12
Source
M. Friendly (2000), Visualizing Categorical Data, pages 40-42.
References
J. K. Lindsey (1995), Analysis of Frequency and Count Data. Oxford University Press, Oxford,
UK.
R. R. Sokal & F. J. Rohlf (1969), Biometry. The Principles and Practice of Statistics. W. H.
Freeman, San Francisco, CA.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("Saxony")
gf <- goodfit(Saxony, type = "binomial")
summary(gf)
plot(gf)
```
sieve Extended Sieve Plots

#### Desription

(Extended) sieve displays for n-way contingency tables: plots rectangles with areas proportional to
the expected cell frequencies and filled with a number of squares equal to the observed frequencies.
Thus, the densities visualize the deviations of the observed from the expected 
#### Value 
.

#### Usage
<pre><code>

## Default S3 method:
sieve(x, condvars = NULL, gp = NULL, shade = NULL,
legend = FALSE, split_vertical = NULL, direction = NULL, spacing = NULL,
spacing_args = list(), sievetype = c("observed","expected"),
gp_tile = gpar(), scale = 1, main = NULL, sub = NULL, ...)
## S3 method for class 'formula'
sieve(formula, data, ..., main = NULL, sub = NULL, subset = NULL)

</code></pre>
#### Arguments

* ``x``: a contingency table in array form, with optional category labels specified in the
dimnames(x) attribute.
condvars vector of integers or character strings indicating conditioning variables, if any.
The table will be permuted to order them first.
formula a formula specifying the variables used to create a contingency table from data.
For convenience, conditioning formulas can be specified; the conditioning variables
will then be used first for splitting. Formulas for sieve displays (unlike
those for doubledecker plots) have no response variable.
data either a data frame, or an object of class "table" or "ftable".
subset an optional vector specifying a subset of observations to be used.
shade logical specifying whether gp should be used or not (see gp). If TRUE and
expected is unspecified, a default model is fitted: if condvars is specified, a
corresponding conditional independence model, and else the total independence
model. If shade is NULL (default), gp is used if specified.
sievetype logical indicating whether rectangles should be filled according to observed or
expected frequencies.
gp object of class "gpar", shading function or a corresponding generating function
(see details of strucplot and shadings). Components of "gpar" objects are
recycled as needed along the last splitting dimension. The default is a modified
version of shading_Friendly: if sievetype is "observed", cells with positive
residuals are painted with a red sieve, and cells with negative residuals with a
blue one. If sievetype is "expected", the sieves' color is gray. Ignored if
shade = FALSE.
sieve 109
gp_tile object of class "gpar", controlling the appearance of all static elements of the
cells (e.g., border and fill color).
scale scaling factor for the sieve.
legend either a legend-generating function, a legend function (see details of strucplot
and legends), or a logical value. If legend is NULL or TRUE and gp is a function,
legend defaults to legend_resbased.
split_vertical vector of logicals of length k, where k is the number of margins of x (default:
FALSE). 
#### Value 
 are recycled as needed. A TRUE component indicates that the
tile(s) of the corresponding dimension should be split vertically, FALSE means
horizontal splits. Ignored if direction is not NULL.
direction character vector of length k, where k is the number of margins of x (
#### Value 

are recycled as needed). For each component, a value of "h" indicates that the
tile(s) of the corresponding dimension should be split horizontally, whereas "v"
indicates vertical split(s).
spacing spacing object, spacing function, or corresponding generating function (see strucplot
for more in
</code></pre>
#### Format 
ion). The default is no spacing at all if x has two dimensions,
and spacing_increase for more dimensions.
spacing_args list of 
</code></pre>
#### Arguments
 for the generating function, if specified (see strucplot for
more in
</code></pre>
#### Format 
ion).
main, sub either a logical, or a character string used for plotting the main (sub) title. If
logical and TRUE, the name of the data object is used.
... Other 
</code></pre>
#### Arguments
 passed to strucplot
Details
sieve is a generic function which currently has a default method and a formula interface. Both are
high-level interfaces to the strucplot function, and produce (extended) sieve displays. Most of the
functionality is described there, such as specification of the independence model, labeling, legend,
spacing, shading, and other graphical parameters.
The layout is very flexible: the specification of shading, labeling, spacing, and legend is modularized
(see strucplot for details).
Value
The "structable" visualized is returned invisibly.
Note
To be faithful to the original definition by Riedwyl & Schüpbach, the default is to have no spacing
between the tiles for two-way tables.
Author(s)
David Meyer <David.Meyer@R-project.org>
110 SpaceShuttle
References
H. Riedwyl & M. Schüpbach (1994), Parquet diagram to plot contingency tables. In F. Faulbaum
(ed.), Softstat '93: Advances in Statistical Software, 293-299. Gustav Fischer, New York.
M. Friendly (2000), Visualizing Categorical Data, SAS Institute, Cary, NC.
David Meyer, Achim Zeileis, and Kurt Hornik (2006). The strucplot framework: Visualizing multiway
contingency tables with vcd. Journal of Statistical Software, 17(3), 1-48. URL http://www.jstatsoft.org/v17/i03/
and available as vignette("strucplot").
See Also
assoc, strucplot, mosaic, structable, doubledecker

#### Examples
```{r}

data("HairEyeColor")
## aggregate over 'sex':
(haireye <- margin.table(HairEyeColor, c(2,1)))
## plot expected 
#### Value 
:
sieve(haireye, sievetype = "expected", shade = TRUE)
## plot observed table:
sieve(haireye, shade = TRUE)
## plot complete diagram:
sieve(HairEyeColor, shade = TRUE)
## example with observed 
#### Value 
 in the cells:
sieve(haireye, shade = TRUE, labeling = labeling_
#### Value 
,
gp_text = gpar(fontface = 2))
## example with expected 
#### Value 
 in the cells:
sieve(haireye, shade = TRUE, labeling = labeling_
#### Value 
,
value_type = "expected", gp_text = gpar(fontface = 2))
## an example for the formula interface:
data("VisualAcuity")
sieve(Freq ~ right + left, data = VisualAcuity)
SpaceShuttle Space Shuttle O-ring Failures

#### Desription

Data from Dalal et al. (1989) about O-ring failures in the NASA space shuttle program. The damage
index comes from a discussion of the data by Tufte (1997).
SpaceShuttle 111

#### Usage
<pre><code>

data("SpaceShuttle")

</code></pre>
#### Format 

A data frame with 24 observations and 6 variables.
FlightNumber Number of space shuttle flight.
Temperature temperature during start (in degrees F).
Pressure pressure.
Fail did any O-ring failures occur? (no, yes).
nFailures how many (of six) 0-rings failed?.
Damage damage index.
Source
* Michael Friendly (2000), Visualizing Categorical Data: http://euclid.psych.yorku.ca/ftp/
sas/vcd/catdata/orings.sas
References
S. Dalal, E. B. Fowlkes, B. Hoadly (1989), Risk analysis of the space shuttle: Pre-Challenger
prediction of failure, Journal of the American Statistical Association, 84, 945-957.
E. R. Tufte (1997), Visual Explanations: Images and Quantities, Evidence and Narrative. Graphics
Press, Cheshire, CT.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("SpaceShuttle")
plot(nFailures/6 ~ Temperature, data = SpaceShuttle,
xlim = c(30, 81), ylim = c(0,1),
main = "NASA Space Shuttle O-Ring Failures",
ylab = "Estimated failure probability",
pch = 19, col = 4)
fm <- glm(cbind(nFailuresnFailures) ~ Temperature,
data = SpaceShuttle,
family = binomial)
lines(30 : 81,
predict(fm, data.frame(Temperature = 30 : 81), type = "re"),
lwd = 2)
abline(v = 31, lty = 3)
112 spacings
spacings Spacing-generating Functions

#### Desription

These functions generate spacing functions to be used with strucplot to obtain customized spaces
between the elements of a strucplot.

#### Usage
<pre><code>

spacing_equal(sp = unit(0.3, "lines"))
spacing_dimequal(sp)
spacing_increase(start = unit(0.3, "lines"), rate = 1.5)
spacing_conditional(sp = unit(0.3, "lines"), start = unit(2, "lines"), rate = 1.8)
spacing_highlighting(start = unit(0.2, "lines"), rate = 1.5)

</code></pre>
#### Arguments

start object of class "unit" indicating the start value for increasing spacings.
rate increase rate for spacings.
sp object of class "unit" specifying a fixed spacing.
Details
These generating functions return a function used by strucplot to generate appropriate spaces
between tiles of a strucplot, using the dimnames in
</code></pre>
#### Format 
ion of the visualized table.
spacing_equal allows to specify one fixed space for all dimensions.
spacing_dimequal allows to specify a fixed space for each dimension.
spacing_increase creates increasing spaces for all dimensions, based on a starting value and an
increase rate.
spacing_conditional combines spacing_equal and spacing_increase to create fixed spaces
for conditioned dimensions, and increasing spaces for conditioning dimensions.
spacing_highlighting is essentially spacing_conditional but with the space of the last dimension
set to 0. With a corresponding color scheme, this gives the impression of the last class being
'highlighted' in the penultimate class (as, e.g., in doubledecker plots).
Value
A spacing function with 
</code></pre>
#### Arguments
:
d "dim" attribute of a contingency table.
condvars index vector of conditioning dimensions (currently only used by spacing_conditional).
This function computes a list of objects of class "unit". Each list element contains the spacing
in
</code></pre>
#### Format 
ion for the corresponding dimension of the table. The length of the "unit" objects is
k ???? 1, k number of levels of the corresponding factor.
spine 113
Author(s)
David Meyer <David.Meyer@R-project.org>
References
Meyer, D., Zeileis, A., and Hornik, K. (2006), The strucplot framework: Visualizing multi-way contingency
tables with vcd. Journal of Statistical Software, 17(3), 1-48. URL http://www.jstatsoft.org/v17/i03/
and available as vignette("strucplot").
See Also
strucplot, doubledecker

#### Examples
```{r}

data("Titanic")
strucplot(Titanic, spacing = spacing_increase(start = 0.5, rate = 1.5))
strucplot(Titanic, spacing = spacing_equal(1))
strucplot(Titanic, spacing = spacing_dimequal(1:4 / 4))
strucplot(Titanic, spacing = spacing_highlighting,
gp = gpar(fill = c("light gray","dark gray")))
data("PreSex")
strucplot(aperm(PreSex, c(1,4,2,3)), spacing = spacing_conditional,
condvars = 2)
spine Spine Plots and Spinograms

#### Desription

Spine plots are a special cases of mosaic plots, and can be seen as a generalization of stacked (or
highlighted) bar plots. Analogously, spinograms are an extension of histograms.

#### Usage
<pre><code>

spine(x, ...)
## Default S3 method:
spine(xNULL,
breaks = NULL, ylab_tol = 0.05, off = NULL,
main = "", xlab = NULL, ylab = NULL, ylim = c(0, 1), margins = c(5.1, 4.1, 4.1, 3.1),
gp = gpar(), name = "spineplot", newpage = TRUE, pop = TRUE,
...)
## S3 method for class 'formula'
spine(formula, data = list(),
breaks = NULL, ylab_tol = 0.05, off = NULL,
main = "", xlab = NULL, ylab = NULL, ylim = c(0, 1), margins = c(5.1, 4.1, 4.1, 3.1),
gp = gpar(), name = "spineplot", newpage = TRUE, pop = TRUE,
...)
114 spine

</code></pre>
#### Arguments

* ``x``: an object, the default method expects either a single variable (interpreted to be
the explanatory variable) or a 2-way table. See details.
y a "factor" interpreted to be the dependent variable
formula a "formula" of typx with a single dependent "factor" and a single
explanatory variable.
data an optional data frame.
breaks if the explanatory variable is numeric, this controls how it is discretized. breaks
is passed to hist and can be a list of 
</code></pre>
#### Arguments
.
ylab_tol convenience tolerance parameter for y-axis annotation. If the distance between
two labels drops under this threshold, they are plotted equidistantly.
off vertical offset between the bars (in per cent). It is fixed to 0 for spinograms and
defaults to 2 for spine plots.
main, xlab, ylab
character strings for annotation
ylim limits for the y axis
margins margins when calling plotViewport
gp a "gpar" object controlling the grid graphical parameters of the rectangles.
It should specify in particular a vector of fill colors of the same length as
levels(y). The default is to call gray.colors.
name name of the plotting viewport.
newpage logical. Should grid.newpage be called before plotting?
pop logical. Should the viewport created be popped?
... additional 
</code></pre>
#### Arguments
 passed to plotViewport.
Details
spine creates either a spinogram or a spine plot. It can be called via spine(x, y) or spine(y ~ x)
where y is interpreted to be the dependent variable (and has to be categorical) and x the explanatory
variable. x can be either categorical (then a spine plot is created) or numerical (then a spinogram is
plotted). Additionally, spine can also be called with only a single argument which then has to be a
2-way table, interpreted to correspond to table(x, y).
Spine plots are a generalization of stacked bar plots where not the heights but the widths of the
bars corresponds to the relative frequencies of x. The heights of the bars then correspond to the
conditional relative frequencies of y in every x group. This is a special case of a mosaic plot with
specific spacing and shading.
Analogously, spinograms extend stacked histograms. As for the histogram, x is first discretized
(using hist) and then for the discretized data a spine plot is created.
Value
The table visualized is returned invisibly.
strucplot 115
Author(s)
Achim Zeileis <Achim.Zeileis@R-project.org>
References
Hummel, J. (1996), Linked bar charts: Analysing categorical data graphically. Computational
Statistics, 11, 23-33.
Hofmann, H., Theus, M. (2005), Interactive graphics for visualizing conditional distributions, Unpublished
Manuscript.
See Also
cd_plot, mosaic, hist

#### Examples
```{r}

## Arthritis data (dependence on a categorical variable)
data("Arthritis")
(spine(Improved ~ Treatment, data = Arthritis))
## Arthritis data (dependence on a numerical variable)
(spine(Improved ~ Age, data = Arthritis, breaks = 5))
(spine(Improved ~ Age, data = Arthritis, breaks = quantile(Arthritis$Age)))
(spine(Improved ~ Age, data = Arthritis, breaks = "Scott"))
## Space shuttle data (dependence on a numerical variable)
data("SpaceShuttle")
(spine(Fail ~ Temperature, data = SpaceShuttle, breaks = 3))
strucplot Structured Displays of Contingency Tables

#### Desription

This modular function visualizes certain aspects of high-dimensional contingency tables in a hierarchical
way.

#### Usage
<pre><code>

strucplot(x, residuals = NULL, expected = NULL,
condvars = NULL, shade = NULL, type = c("observed", "expected"),
residuals_type = NULL, df = NULL, split_vertical = NULL,
spacing = spacing_equal, spacing_args = list(),
gp = NULL, gp_args = list(),
labeling = labeling_border, labeling_args = list(),
core = struc_mosaic, core_args = list(),
legend = NULL, legend_args = list(),
main = NULL, sub = NULL, margins = unit(3, "lines"),
116 strucplot
title_margins = NULL, legend_width = NULL,
main_gp = gpar(fontsize = 20), sub_gp = gpar(fontsize = 15),
newpage = TRUE, pop = TRUE, return_grob = FALSE,
keep_aspect_ratio = NULL, prefix = "", ...)

</code></pre>
#### Arguments

* ``x``: a contingency table in array form, with optional category labels specified in the
dimnames attribute.
residuals optionally, an array of residuals of the same dimension as x (see details).
expected optionally, an array of expected 
#### Value 
 of the same dimension as x, or alternatively
the corresponding independence model specification as used by loglin
or loglm (see details).
df degrees of freedom passed to the shading functions used for inference. Will be
calculated (and overwritten if specified) if both expected and residuals are
NULL, or if expected is given a formula.
condvars number of conditioning variables, if any; those are expected to be ordered first
in the table. This in
</code></pre>
#### Format 
ion is used for computing the expected 
#### Value 
, and is
also passed to the spacing functions (see spacings).
shade logical specifying whether gp should be used or not (see gp). If TRUE and
expected is unspecified, a default model is fitted: if condvars is specified, a
corresponding conditional independence model, and else the total independence
model.
residuals_type a character string indicating the type of residuals to be computed when none are
supplied. If residuals is NULL, residuals_type must be one of "pearson"
(default; giving components of Pearson's chi-squared), "deviance" (giving components
of the likelihood ratio chi-squared), or "FT" for the Freeman-Tukey
residuals. The value of this argument can be abbreviated. If residuals are
specified, the value of residuals_type is just passed "as is" to the legend function.
type a character string indicating whether the observed or the expected 
#### Value 
 of the
table should be visualized.
split_vertical vector of logicals of length k, where k is the number of margins of x (
#### Value 

are recycled as needed). A TRUE component indicates that the tile(s) of the corresponding
dimension should be split vertically, FALSE means horizontal splits.
Default is FALSE.
spacing spacing object, spacing function, or a corresponding generating function (see
details and spacings).
spacing_args list of 
</code></pre>
#### Arguments
 for the spacing-generating function, if specified.
gp object of class "gpar", shading function or a corresponding generating function
(see details and shadings). Components of "gpar" objects are recycled as
needed along the last splitting dimension. Ignored if shade = FALSE.
gp_args list of 
</code></pre>
#### Arguments
 for the shading-generating function, if specified.
labeling either a logical, or a labeling function, or a corresponding generating function
(see details and labelings. If FALSE or NULL, no labeling is produced.
strucplot 117
labeling_args list of 
</code></pre>
#### Arguments
 for the labeling-generating function, if specified.
core either a core function, or a corresponding generating function (see details). Currently,
generating functions for mosaic plots (struc_mosaic), association plots
(struc_assoc), and sieve plots (struc_sieve) are provided.
core_args list of 
</code></pre>
#### Arguments
 for the core-generating function, if specified.
legend either a legend-generating function, or a legend function (see details and legends),
or a logical. If legend is NULL or TRUE and gp is a function, legend defaults to
legend_resbased.
legend_args list of 
</code></pre>
#### Arguments
 for the legend-generating function, if specified.
main either a logical, or a character string used for plotting the main title. If main is a
logical and TRUE, the name of the object supplied as x is used.
sub a character string used for plotting the subtitle. If sub is a logical and TRUE and
main is unspecified, the name of the object supplied as x is used.
margins either an object of class "unit" of length 4, or a numeric vector of length 4.
The elements are recycled as needed. The four components specify the top,
right, bottom, and left margin of the plot, respectively. When a numeric vector
is supplied, the numbers are interpreted as "lines" units. In addition, the
unit or numeric vector may have named 
</code></pre>
#### Arguments
 ('top', 'right', 'bottom',
and 'left'), in which case the non-named 
</code></pre>
#### Arguments
 specify the default 
#### Value 

(recycled as needed), overloaded by the named 
</code></pre>
#### Arguments
.
title_margins either an object of class "unit" of length 2, or a numeric vector of length 2. The
elements are recycled as needed. The two components specify the top and bottom
title margin of the plot, respectively. The default for each specified title are
2 lines (and 0 else), except when a legend is plotted and keep_aspect_ratio
is TRUE: in this case, the default 
#### Value 
 of both margins are set as to align the
heights of legend and actual plot. When a numeric vector is supplied, the numbers
are interpreted as "lines" units. In addition, the unit or numeric vector may
have named 
</code></pre>
#### Arguments
 ('top' and 'bottom'), in which case the non-named argument
specify the default value (recycled as needed), overloaded by the named

</code></pre>
#### Arguments
.
legend_width An object of class "unit" of length 1 specifying the width of the legend (if any).
Default: 5 lines.
pop logical indicating whether the generated viewport tree should be removed at the
end of the drawing or not.
main_gp, sub_gp
object of class "gpar" containing the graphical parameters used for the main
(sub) title, if specified.
newpage logical indicating whether a new page should be created for the plot or not.
return_grob logical. Should a snapshot of the display be returned as a grid grob?
keep_aspect_ratio
logical indicating whether the aspect ratio should be fixed or not. If unspecified,
the default is TRUE for two-dimensional tables and FALSE otherwise.
prefix optional character string used as a prefix for the generated viewport and grob
names.
... For convenience, list of 
</code></pre>
#### Arguments
 passed to the labeling-generating function
used.
118 strucplot
Details
This function-usually called by higher-level functions such as assoc and mosaic-generates conditioning
plots of contingency tables. First, it sets up a set of viewports for main- and subtitles,
legend, and the actual plot region. Then, residuals are computed as needed from observed and
expected frequencies, where the expected frequencies are optionally computed for a specified independence
model. Finally, the specified functions for spacing, gp, main plot, legend, and labeling
are called to produce the plot. The function invisibly returns the "structable" object visualized.
Most elements of the plot, such as the core function, the spacing between the tiles, the shading
of the tiles, the labeling, and the legend, are modularized in graphical appearance control ("grapcon")
functions and specified as parameters. For each element foo (= spacing, labeling, core,
or legend), strucplot takes two 
</code></pre>
#### Arguments
: foo and foo\_args, which can be used to specify the
parameters in the following alternative ways:
1. Passing a suitable function to foo which subsequently will be called from strucplot to compute
shadings, labelings, etc.
2. Passing a corresponding generating function to foo, along with parameters passed to foo\_args,
that generates such a function. Generating functions must inherit from classes "grapcon_generator"
and "}foo\code{".
3. Except for the shading functions (shading\_bar), passing foo(foo\_args) to the foo argument.
4. For shadings and spacings, passing the final parameter object itself; see the corresponding
help pages for more details on the data structures.
If legends are drawn, a 'cinemascope'-like layout is used for the plot to preserve the 1:1 aspect ratio.
If type = "expected", the expected 
#### Value 
 are passed to the observed argument of the core
function, and the observed 
#### Value 
 to the expected argument.
Although the gp argument is typically used for shading, it can be used for arbitrary modifications
of the tiles' graphics parameters (e.g., for highlighting particular cells, etc.).
Value
Invisibly, an object of class "structable" corresponding to the plot. If return_grob is TRUE,
additionally, the plot as a grob object is returned in a grob attribute.
Note
The created viewports, as well as the tiles and bullets, are named and thus can conveniently modified
after a plot has been drawn (and pop = FALSE).
Author(s)
David Meyer <David.Meyer@R-project.org>
References
Meyer D., Zeileis A., and Hornik K. (2006), The strucplot framework: Visualizing multi-way contingency
tables with vcd. Journal of Statistical Software, 17(3), 1-48. URL http://www.jstatsoft.org/v17/i03/
and available as vignette("strucplot").
structable 119
See Also
assoc, mosaic, sieve, struc_assoc, struc_sieve, struc_mosaic, structable, doubledecker,
labelings, shadings, legends, spacings

#### Examples
```{r}

data("Titanic")
strucplot(Titanic)
strucplot(Titanic, core = struc_assoc)
strucplot(Titanic, spacing = spacing_increase,
spacing_args = list(start = 0.5, rate = 1.5))
strucplot(Titanic, spacing = spacing_increase(start = 0.5, rate = 1.5))
## modify a tile's color
strucplot(Titanic, pop = FALSE)
grid.edit("rect:Class=1st,Sex=Male,Age=Adult,Survived=Yes",
gp = gpar(fill = "red"))

```


struc_mosaic Core-ge
mary of a 2-way Table

#### Desription

Prints a 2-way contingency table along with percentages, marginal, and conditional distributions.

#### Usage
<pre><code>

table2d_summary(object, margins = TRUE, percentages = FALSE,
conditionals = c("none", "row", "column"), chisq.test = TRUE, ...)

</code></pre>
#### Arguments

objec c-contingency table
margins if TRUE, marginal distributions are computed.
percentages if TRUE, relative frequencies are computed.
conditionals if not "none", the conditional distributions, given the row/column factor, are
computed.
chisq.test if TRUE, a chi-squared test of independence is carried out.
... currently not used.
Value
Returns invisiblk table, k depending on the amount of choices (at most 3).
Author(s)
David Meyer <David.Meyer@R-project.org>
See Also
mar_table, prop.table, independence_table

#### Examples
```{r}

data("UCBAdmissions")
table2d_summary(margin.table(UCBAdmissions, 1:2))

UKSoccer UK Soccer Scores

#### Desription

Data from Lee (1997), on the goals scored by Home and Away teams in the Premier Football
League, 1995/6 season.

#### Usage
<pre><code>

data("UKSoccer")

</code></pre>
#### Format 

A 2-dimensional array resulting from cross-tabulating the number of goals scored in 380 games.
The variables and their levels are as follows:
No Name Levels
1 Home 0, 1. , 4
2 Away 0, 1. , 4
Source
M. Friendly (2000), Visualizing Categorical Data, page 27.
References
A. J. Lee (1997), Modelling scores in the Premier League: Is Manchester United really the best?,
Chance, 10(1), 15-19.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.
See Also
Bundesliga

#### Examples
```{r}

data("UKSoccer")
mosaic(UKSoccer, gp = shading_max, main = "UK Soccer Scores")
VisualAcuity Visual Acuity in Left and Right Eyes

#### Desription

Data from Kendall & Stuart (1961) on unaided vision among 3,242 men and 7,477 women, all aged
30-39 and employed in the U.K. Royal Ordnance factories 1943-1946.
VonBort 135

#### Usage
<pre><code>

data("VisualAcuity")

</code></pre>
#### Format 

A data frame with 32 observations and 4 variables.
Freq frequency of visual acuity measurements.
right visual acuity on right eye.
left visual acuity on left eye.
gender factor indicating gender of patient.
Source
M. Friendly (2000), Visualizing Categorical Data: http://euclid.psych.yorku.ca/ftp/sas/
vcd/catdata/vision.sas
References
M. G. Kendall & A. Stuart (1961), The Advanced Theory of Statistics, Vol. 2. Griffin, London.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("VisualAcuity")
structable(~ gender + left + right, data = VisualAcuity)
sieve(Freq ~ left + right | gender, data = VisualAcuity, shade = TRUE)
cotabplot(Freq ~ left + right | gender, data = VisualAcuity,
panel = cotab_agreementplot)
VonBort Von Bortkiewicz Horse Kicks Data

#### Desription

Data from von Bortkiewicz (1898), given by Andrews \& Herzberg (1985), on number of deaths by
horse or mule kicks in 14 corps of the Prussian army.

#### Usage
<pre><code>

data("VonBort")

</code></pre>
#### Format 

A data frame with 280 observations and 4 variables.
deaths number of deaths.
year year of the deaths.
corps factor indicating the corps.
fisher factor indicating whether the corresponding corps was considered by Fisher (1925) or not.
Source
* , Visualizing Categorical Data: http://euclid.psych.yorku.ca/ftp/
sas/vcd/catdata/vonbort.sas
References
D. F. Andrews \& A. M. Herzberg (1985), Data: A Collection of Problems from Many Fields for
the Student and Research Worker. Springer-Verlag, New York, NY.
R. A. Fisher (1925), Statistical Methods for Research Workers. Oliver & Boyd, London.
L. von Bortkiewicz (1898), Das Gesetz der kleinen Zahlen. Teubner, Leipzig.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.
See Also
HorseKicks for a popular subsample.

#### Examples
```{r}

data("VonBort")
## HorseKicks data
xtabs(~ deaths, data = VonBort, subset = fisher == "yes")
WeldonDice Weldon's Dice Data

#### Desription

Data from Pearson (1900) about the frequency of 5s and 6s in throws of 12 dice. Weldon tossed the
dice 26,306 times and reported his results in a letter to Francis Galton on 1894-02-02.

#### Usage
<pre><code>

data("WeldonDice")

</code></pre>
#### Format 

A 1-way table giving the frequency ooin 26,306 throws of 12 dice where 10 indicates '10
or more' 5s or 6s. The variable and its levels are
WomenQueue 137
No Name Levels
1 n56 0, 1. , 10
Source
M. Friendly (2000), Visualizing Categorical Data, pages 20-21.
References
K. Pearson (1900), On the criterion that a given system of deviations from the probable in the case
of a correlated system of variables is such that it can be reasonably supposed to have arisen by
random sampling, Philosophical Magazine, 50 (5th series), 157-175.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("WeldonDice")
gf <- goodfit(WeldonDice, type = "binomial")
summary(gf)
plot(gf)
WomenQueue Women in Queues

#### Desription

Data from Jinkinson \& Slater (1981) and Hoaglin \& Tukey (1985) reporting the frequency distribution
of females in 100 queues of length 10 in a London Underground station.

#### Usage
<pre><code>

data("WomenQueue")

</code></pre>
#### Format 

A 1-way table giving the number of women in 100 queues of length 10. The variable and its levels
are
No Name Levels
1 nWomen 0, 1. , 10
Source
M. Friendly (2000), Visualizing Categorical Data, pages 19-20.
138 woolf_test
References
D. C. Hoaglin \& J.W. Tukey (1985), Checking the shape of discrete distributions. In D. C. Hoaglin,
F. Mosteller, J. W. Tukey (eds.), Exploring Data Tables, Trends and Shapes, chapter 9. John Wiley
\& Sons, New York.
R. A. Jinkinson \& M. Slater (1981), Critical discussion of a graphical method for identifying
discrete distributions, The Statistician, 30, 239-248.
M. Friendly (2000), Visualizing Categorical Data. SAS Institute, Cary, NC.

#### Examples
```{r}

data("WomenQueue")
gf <- goodfit(WomenQueue, type = "binomial")
summary(gf)
plot(gf)
woolf_test Woolf Test

#### Desription

Test for homogeneity otables over strata (i.e., whether the log odds ratios are the same
in all strata).

#### Usage
<pre><code>

woolf_test(x)

</code></pre>
#### Arguments


Value
A list of class "htest" containing the following components:
statistic the chi-squared test statistic.
parameter degrees of freedom of the approximate chi-squared distribution of the test statistic.
* ``p.value``: p-value for the test.
method a character string indicating the type of test performed.
* ``data.name``:  a character string giving the name(s) of the data.
observed the observed counts.
expected the expected counts under the null hypothesis.
woolf_test 139
References
Woolf, B. 1955. On estimating the relation between blood group and disease. Ann. Human Genet.
(London) 19, 251-253.
See Also
mantelhaen.test

#### Examples
```{r}

data("CoalMiners")
woolf_test(CoalMiners)
```
